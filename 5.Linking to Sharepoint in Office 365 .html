<p>If your Office 365 account&nbsp;uses Microsoft SharePoint websites, you can achieve&nbsp;smart linking (also known as deep linking) into them through OneLogin.</p>
<p>Begin by creating the Smart Link URL. This involves using an HTTP tracer to capture the web traffic during a sign in to a specific SharePoint site and then removing certain parameters from the URL to make it "generic" for all users in an organization.</p>
<p>Once you understand how to construct a smart link for the target Office 365 service, you can deploy a 302 redirection service on your on-premise web servers.&nbsp; This assumes that you have already set up Single Sign-On (Identity Federation) for Office 365 and have verified that it is working correctly.</p>
<h3>Creating a Smart Link</h3>
<p>The simplest way to create a smart link is to turn on an HTTP tracing tool and authenticate to the service you want. In the future, Office 365 may provide a service for administrators that automatically constructs the smart link.&nbsp; Until that time, please follow the manual instructions below.</p>
<ol>
	<li>Open your browser and&nbsp;HTTP tracing</li>
	<li>Perform a federated authentication to the service that you want a smart link for by going to the service (like <a style="background-color: #ffffff;" href="https://portal.microsoftonline.com/">https://portal.microsoftonline.com/</a>) and signing in.</li>
	<li>From the HTTP trace tool, find the last line of data that has your OneLogin address (in the form of https://https://app.onelogin.com/trust/wsfed2007-06/passive/sso/123456) in the list of URLs.</li>
	<li>Copy and paste the line into your text editor of choice. You should see something similar to the following (using OneLogin&nbsp;and the Office 365 portal as examples):<br /><br /><a style="background-color: #ffffff;" href="https://app.onelogin.com/trust/wsfed2007-06/passive/sso/123456?wa=wsignin1.0&amp;wtrealm=urn:federation:MicrosoftOnline&amp;wctx=wa%3Dwsignin1.0%26rpsnv%3D4%26ct%3D1420495444%26rver%3D6.1.6206.0%26wp%3DMBI%26wreply%3Dhttps:%252F%252Fonelogin224.sharepoint.com%252F_forms%252Fdefault.aspx%26lc%3D1033%26id%3D500046%26%26">https://app.onelogin.com/trust/wsfed2007-06/passive/sso/123456</a><a style="background-color: #ffffff;" href="https://sts.contoso.com/adfs/ls/?cbcxt=&amp;vv=&amp;username=johndoe%40contoso.com&amp;mkt=&amp;lc=1033&amp;wa=wsignin1.0&amp;wtrealm=urn:federation:MicrosoftOnline&amp;wctx=MEST%3D0%26LoginOptions%3D2%26wa%3Dwsignin1.0%26rpsnv%3D2%26ct%3D1292977249%26rver%3D6.1.6206.0%26wp%3DMCMBI%26wreply%3Dhttps:%252F%252Fportal.microsoftonline.com%252FDefault.aspx%26lc%3D1033%26id%3D271345%26bk%3D1292977249">?<strong>cbcxt=&amp;vv=&amp;username=johndoe%40onelogin.com&amp;mkt=&amp;lc=1033&amp;</strong>wa=wsignin1.0&amp;wtrealm=urn:federation:MicrosoftOnline&amp;wctx=MEST%3D0%26LoginOptions%3D2%26wa%3Dwsignin1.0%26rpsnv%3D2%26<strong>ct%3D1292977249%26r</strong>ver%3D6.1.6206.0%26wp%3DMCMBI%26wreply%3Dhttps:%252F%252Fportal.microsoftonline.com%252FDefault.aspx%26lc%3D1033%26id%3D271345<strong>%26bk%3D1292977249</strong></a></li>
	<li>Edit the above URL by removing the bolded items: everything up to the "wa" query-string parameter, the last QS parameter "bk", and the "ct" parameter up to the "ver" parameter They will appear as shown in your traced URL and will give you the resulting URL.<br /><br /><a href="https://app.onelogin.com/trust/wsfed2007-06/passive/sso/123456?wa=wsignin1.0&amp;wtrealm=urn:federation:MicrosoftOnline&amp;wctx=wa%3Dwsignin1.0%26rpsnv%3D4%26ct%3D1420495444%26rver%3D6.1.6206.0%26wp%3DMBI%26wreply%3Dhttps:%252F%252Fonelogin224.sharepoint.com%252F_forms%252Fdefault.aspx%26lc%3D1033%26id%3D500046%26%26">https://app.onelogin.com/trust/wsfed2007-06/passive/sso/123456</a><a href="https://sts.contoso.com/adfs/ls/?wa=wsignin1.0&amp;wtrealm=urn:federation:MicrosoftOnline&amp;wctx=MEST%3D0%26LoginOptions%3D2%26wa%3Dwsignin1.0%26rpsnv%3D2%26ver%3D6.1.6206.0%26wp%3DMCMBI%26wreply%3Dhttps:%252F%252Fportal.microsoftonline.com%252FDefault.aspx%26lc%3D1033%26id%3D271345">?wa=wsignin1.0&amp;wtrealm=urn:federation:MicrosoftOnline&amp;wctx=MEST%3D0%26LoginOptions%3D2%26wa%3Dwsignin1.0%26rpsnv%3D2%26ver%3D6.1.6206.0%26wp%3DMCMBI%26wreply%3Dhttps:%252F%252Fportal.microsoftonline.com%252FDefault.aspx%26lc%3D1033%26id%3D271345</a></li>
	<li>Create a vanity URL for users to reach the Office 365 portal in the most seamless single-sign-on fashion, by following the steps in "Deploying a smart link".</li>
</ol>
<h3>Deploying&nbsp;a Smart Link</h3>
<p>Once you've created your smart link, you'll need to deploy it by creating a vanity URL for your organization's users to use. In the example above we created a smart link for the Office 365&nbsp;portal (<a href="https://portal.microsoftonline.com/">https://portal.microsoftonline.com/</a>). Now we'll create a vanity URL that will redirect&nbsp;to the smart link above.</p>
<p>The vanity URL uses a 301 redirect and the customers registered/desired domain name which will require establishing&nbsp;a Windows IIS server.</p>
<ol>
	<li>Create a new record in your domain registrar (like <strong>portal.acmecorp.com</strong>) and point this to the IP address of your IIS server that will host your redirection service.</li>
	<li>Create a new web site (<strong>portal.acmecorp.com</strong>) on your IIS server.</li>
	<li>Create a 302 redirection service and paste the smart link into the target address.</li>
	<li>Test that <a href="/hc/admin/articles/203543414-Linking-to-Sharepoint-in-Office-365/portal.acmecorp.com">portal.acmecorp.com</a> resolves to the correct IP address inside and outside your corporate network.</li>
	<li>Open IE and type <a style="background-color: #ffffff;" href="http://portal.contoso.com/">http://portal.acmecorp.com/</a> and you should get seamless single sign-on directly to the Office 365 portal.</li>
</ol>
<p>While OneLogin can recommend steps on how to configure a vanity URL, it can't configure it as it&nbsp;doesn't&nbsp;administrate&nbsp;remote name servers.</p>